# Data Science in Malicious Files Search: Project Overview
Created a tool that predicts whether a file is malicious based on a list of statically imported .exe file libraries.
* Preprocessed data for analysis
* Conducted a comparative analysis of different classifiers: Logistic Regression, Decision Tree Classifier, K-Neighbors Classifier, SGD Classifier
* Illustrated quality of classifiers by PR and ROC curves
* Compiled a report on the quality of classifiers based on validation data (validation.txt)
* Created a forecast of the file's malignancy based on the imported libraries (1 — if the file is malicious, 0 - otherwise) (prediction.txt)
* Created an explanation file, where for each line of the test sample file contains the reason why the model considered this file malicious (the lines for non-malicious files remain empty) (explain.txt)

## Code and Resources Used
* Python Version: 3.9.5
* Packages: pandas, numpy, sklearn, matplotlib, pickle

## Data Preprocessing
The samples are presented in the form of .tsv files with three columns:
* **is_virus** – whether the file is malicious: 1=yes, 0=no; 
* **filename** - the file name for review; 
* **libs** - comma-separated enumeration of libraries statically imported by this file (the LIEF library was used to get the list).

I needed to convert data so that it was usable for our models. I made the following changes:
* Convert text data to a matrix of token counts
* Split the data into train subsets

##Exploratory data analysis
I looked at the distributions of the data and class balance.
![This is an image](data:image/png;base64,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)

Below are a few highlights from the pivot tables.


